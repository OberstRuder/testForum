@model TestForum.Models.Theme
@using Microsoft.AspNetCore.Identity

@inject SignInManager<IdentityUser> SignInManager
@inject UserManager<IdentityUser> UserManager

@{
    ViewData["Title"] = "Details";
}

<h3>@Model.Title</h3>
<p>@Model.Description</p>
<p>- @Model.User.UserName</p>

<h3>Posts</h3>
@foreach(var post in Model.Posts)
{
    <p>
        @post.Content - @post.User.Email

        @if (UserManager.GetUserId(User) == post.IdentityUserId || User.IsInRole("Admin"))
        {
            <a asp-action="DeletePost" asp-route-id="@post.Id">Delete</a>
        }
    </p>
    <hr />
}

<form asp-action="AddPost">
    <div class="form-group">
        <textarea name="content" class="form-control"></textarea>
    </div>
    <div class="form-group">
        <input type="hidden" name="IdentityUserId" class="form-control" value="@UserManager.GetUserId(User)" />
    </div>
    <div class="form-group">
        <input type="hidden" name="ThemeId" class="form-control" value="@Model.Id" />
    </div>
    <div class="form-group">
        <input type="Submit" class="btn btn-info" value="Submit" />
    </div>
</form>

<div>
    <a asp-action="Index">Back to List</a>
</div>
